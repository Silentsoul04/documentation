# NETWORK DATA SOURCES

#### NETWORK DATA SOURCES

Network data is typically analyzed in detail at the level of individual frames or using summary statistics of traffic flows and protocol usage.

**Protocol Analyzer Output**  
A SIEM will store details from sensors at different points on the network. Information captured from network packets can be aggregated and summarized to show overall protocol usage and endpoint activity. The contents of packets can also be recorded for analysis. Recording the full data of every packet—referred to as retrospective network analysis (RNA)—is too costly for most organizations. Typically, packet contents are only retained when indicators from the traffic are correlated as an event. The SIEM software will provide the ability to pivot from the event or alert summary to the underlying packets. Detailed analysis of the packet contents can help to reveal the tools used in an attack. It is also possible to extract binary files such as potential malware for analysis.

**Netflow/IPFIX**  
A flow collector is a means of recording metadata and statistics about network traffic rather than recording each frame. Network traffic and flow data may come from a wide variety of sources (or probes), such as switches, routers, firewalls, web proxies, and so forth. Flow analysis tools can provide features such as:

-   Highlighting of trends and patterns in traffic generated by particular applications, hosts, and ports.
  
-   Alerting based on detection of anomalies, flow analysis patterns, or custom triggers.
  
-   **Visualization** tools that enable you to quickly create a map of network connections and interpret patterns of traffic and flow data.
  
-   Identification of traffic patterns revealing rogue user behavior, malware in transit, tunneling, applications exceeding their allocated bandwidth, and so forth.
  
-   Identification of attempts by malware to contact a handler or command & control (C&C) channel.
  

**NetFlow** is a Cisco-developed means of reporting network flow information to a structured database. NetFlow has been redeveloped as the **IP Flow Information Export (IPFIX)** IETF standard (tools.ietf.org/html/rfc7011). A particular traffic flow can be defined by packets sharing the same characteristics, referred to as keys, such as IP source and destination addresses and protocol type. A selection of keys is called a flow label, while traffic matching a flow label is called a flow record.

You can use a variety of NetFlow monitoring tools to capture data for point-in-time analysis and to diagnose any security or operational issues the network is experiencing. There are plenty of commercial NetFlow suites, plus products offering similar functionality to NetFlow. The SiLK suite (tools.netsa.cert.org/silk/) and nfdump/nfsen (nfsen.sourceforge.net/) are examples of open-source implementations. Another popular tool is Argus (openargus.org). This uses a different data format to NetFlow, but the client tools can read and translate NetFlow data.

**sFlow**  
**sFlow**, developed by HP and subsequently adopted as a web standard (tools.ietf.org/html/rfc3176), uses sampling to measure traffic statistics at any layer of the OSI model for a wider range of protocol types than the IP-based Netflow. sFlow can also capture the entire packet header for samples.

**Bandwidth Monitor**  
Bandwidth usage can be a key indicator of suspicious behavior, if you have reliable baselines for comparison. Unexpected bandwidth consumption could be evidence of a data exfiltration attack, for instance. Bandwidth usage can be reported by flow collectors. Firewalls and web security gateways are also likely to support bandwidth monitoring and alerting.