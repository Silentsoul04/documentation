# Cryptography Supporting Confidentiality

#### CRYPTOGRAPHY SUPPORTING CONFIDENTIALITY

Cryptography removes the need to store or transfer messages over secure media. It does not matter if a ciphertext is stolen or intercepted because the threat actor will not be able to understand or change what has been stolen. This use of cryptography fulfils the goal of confidentiality. For this use case, you cannot simply use asymmetric encryption and private/public key pairs, because the algorithm cannot encrypt large amounts of data efficiently. For example, the RSA asymmetric cipher has a maximum message size of the key size (in bytes) minus 11. A key size of 2048 bits allows a maximum message size of 245 bytes: (2048/8) − 11. The computational overhead of using this type of algorithm to encrypt the contents of a disk or stream of network traffic is far too high.

Therefore, bulk data encryption uses a symmetric cipher, such as AES. A symmetric cipher can encrypt and decrypt data files and streams of network traffic quickly. The problem is that distributing a symmetric key securely is challenging. The more people who know the key value, the weaker the confidentiality property is. The risks of a threat actor obtaining the key grow exponentially. Luckily, symmetric keys are only 128 bits or 256 bits long, and so can easily be encrypted using a public key. Consequently, most cryptographic systems use both symmetric and asymmetric encryption.

Encryption supporting confidentiality is used for both data-at-rest (file encryption) and data-in-transit (transport encryption):

-   File encryption—the user is allocated an asymmetric cipher key pair. The private key is written to secure storage—often a trusted platform module (TPM)—and is only available when the user has authenticated to his or her account. The public key is used to encrypt a randomly generated AES cipher key. When the user tries to encrypt or decrypt files, the AES cipher key is decrypted using the private key to make it available for the encryption or decryption operation.
    
-   Transport encryption—this uses either digital envelopes or perfect forward secrecy. For HTTPS, a web server is allocated a key pair and stores the private key securely. The public key is distributed to clients via a digital certificate. The client and server use the key pair to exchange or agree on one or more AES cipher keys to use as session keys.