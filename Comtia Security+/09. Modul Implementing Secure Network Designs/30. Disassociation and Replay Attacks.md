# Disassociation and Replay Attacks

#### DISASSOCIATION AND REPLAY ATTACKS

The use of a rogue WAP may be coupled with a **deauthentication** attack. This sends a stream of spoofed frames to cause a client to deauthenticate from a WAP. The deauth frames spoof the MAC address of the target station. This might allow the attacker to perform a replay attack aimed at recovering the network key or interpose a rogue WAP.

A similar attack hits the target with disassociation packets, rather than fully deauthenticating the station. A disassociated station is not completely disconnected, but neither can it communicate on the network until it reassociates. Both attacks may also be used to perform a denial of service attack against the wireless infrastructure. The attacks can be mitigated if the wireless infrastructure supports Management Frame Protection (MFP/802.11w). Both the WAP and clients must be configured to support MFP.

Pre-shared key authentication is vulnerable to various types of replay attack that aim to capture the hash of the passphrase when a wireless station associates with an access point. Once the hash is captured it can be subjected to offline brute-force and dictionary cracking. In WEP, these are referred to as initialization vector (IV) attacks, because they exploit flaws in the mechanism that is supposed to ensure a unique keystream, given the same key. A type of replay attack is used to make the access point generate lots of packets, usually by deauthenticating a station, capturing its encrypted ARP packet, and replaying this rapidly, causing the WAP to cycle through IV values quickly, revealing the hash part.

WPA and WPA2 are not vulnerable to **IV attacks**, but a serious vulnerability was discovered in 2017 ([krackattacks.com](https://course.adinusa.id/sections/disassociation-and-replay-attacks)). A KRACK attack uses a replay mechanism that targets the 4-way handshake. KRACK is effective regardless of whether the authentication mechanism is personal or enterprise. It is important to ensure both clients and access points are fully patched against such attacks.